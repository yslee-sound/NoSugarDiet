# Play Store 릴리스 워크플로우 (내부 테스트 → 프로덕션)

본 문서는 AlcoholicTimer 앱을 Google Play Console에 "내부 테스트"로 등록한 이후, 프로덕션(또는 단계적 롤아웃)까지 안정적으로 진행하기 위한 최소·실무형 절차를 정리한 것입니다. 반복 가능한 체계와 빠른 핫픽스 대응을 목표로 합니다.

> 빠르게 내부 테스트만 진행할 때의 10분짜리 최소 카드가 필요하면 `INTERNAL_TEST_CHECKLIST.md` 를 먼저 확인하세요.

---
## 0. 용어 & 범위
- 내부 테스트(Internal Testing): 빠른 배포(최대 100명) → 팀/지인 사전 검증.
- 클로즈드/오픈 테스트: 선택 사항. 현재 스코프는 내부 테스트 → 바로 프로덕션(단계적) 기준.
- AAB: Android App Bundle (Play 업로드 기본 산출물)
- versionCode 전략: `yyyyMMddNN` (날짜 + 2자리 시퀀스). 예) 2025-10-05 첫 2개 빌드: `2025100500`, `2025100501` …
- versionName: 사용자 표시용 (예: `1.0.0`).

---
## 1. 사전 준비 체크리스트
| 구분 | 항목 | OK 조건 |
|------|------|---------|
| 프로젝트 | `applicationId` | 고정: `kr.sweetapps.alcoholictimer` |
| 버전 | `versionCode` | 날짜 기반 규칙 준수 (증가 필수) |
| 서명 | release keystore | 프로덕션 전 환경변수(KEYSTORE_PATH 등) 설정 확인 |
| 빌드 | 난독화/최적화 | release: R8 활성 (minifyEnabled=true) |
| NDK 심볼 | 필요성 판단 | 네이티브 크래시 분석 불필요 시 제거 가능 |
| QA 기기 | 최소 1대 | 실제 앱 설치 및 체크 수행 가능 |

---
## 2. 내부 테스트 트랙 설정 (최초 1회)
1. Play Console → 앱 선택 → 테스트 → 내부 테스트
2. 테스트 설정 → 테스터 추가(이메일 / Google 그룹)
3. 릴리스 만들기 → AAB 업로드 → 간단 릴리스 노트 작성 → 저장 & 게시
4. 생성된 테스터 링크 복사 → 테스터에게 전달 → 참여(Opt-in) 후 Play 스토어에서 설치 가능

(이미 내부 테스트 빌드를 성공적으로 배포했다면 본 섹션은 재실행 불필요)

---
## 3. 빌드 & 업로드 절차 (반복)
1. `app/build.gradle.kts` 에서:
   - versionCode 증가 (날짜 동일 시 NN +1, 날짜 바뀌면 새 날짜 + `00`)
   - versionName 변경(필요 시)
2. 로컬 서명 준비 (프로덕션 빌드 시):
   - 환경변수: `KEYSTORE_PATH`, `KEYSTORE_STORE_PW`, `KEY_ALIAS`, `KEY_PASSWORD`
3. AAB 생성:
```
./gradlew :app:bundleRelease
```
4. 산출물 위치:
```
app/build/outputs/bundle/release/app-release.aab
```
5. 내부 테스트 트랙에 동일 AAB 교체/업로드 → 게시
6. (옵션) 업로드 후 git 태그/CHANGELOG 업데이트 (섹션 6 참조)

---
## 4. 내부 테스트 최소 QA 체크리스트 (실기기 1대)
목표: 프로덕션 이전에 핵심 기능과 상태 보존이 정상임을 10분 내 확실히.

절차 (첫 실행 ~ 로그 확인)
1. (권장) 기존 앱 삭제 → Play 내부 테스트 링크 통해 설치 (스토어 설치본 확인)
2. 첫 실행:
   - 기본 목표 기간(예: 30) 표시
   - 시작 버튼 → 진행 화면 전환 OK
3. 앱 완전 종료 후 재실행:
   - 최근 앱 목록에서 제거 → 다시 실행 → 진행 상태(남은 시간/진행률) 유지
4. 1~2분 경과 관찰:
   - 카운트다운/진행률 자연스럽게 감소/갱신
   - UI 멈춤/이상 없음
5. 다크 모드 토글(시스템 설정):
   - 텍스트 대비 / 배경 깨짐 없음
6. 로케일 EN 전환(시스템 언어 English):
   - 크래시 없음 (미번역 문자열은 허용)
7. Logcat (level=Error, tag 앱 패키지) 관찰:
   - 크래시 스택 / E 태그 비정상 항목 없음

결과: 모두 통과 시 "QA PASS (날짜, 빌드 versionCode)" 메모 남김.

이슈 발견 시:
- 재현 단계 간단 기록 → 코드 수정 → (versionCode 증가 불필요, 내부 테스트 내에서는 동일 코드 교체 가능하나 권장: 시퀀스 +1) → 재업로드 → 재검증.

---
## 5. 프로덕션 릴리스 (단계적 권장)
권장 플로우: 10% 단계적 → 24~48h 모니터 → 100% 확장.

단계:
1. Play Console → 프로덕션 → 새 릴리스
2. AAB 선택: 내부 테스트 승인된 동일 AAB 재사용 또는 다시 업로드 (hash 동일 OK)
3. 출시 노트 작성 (아래 템플릿 활용)
4. 단계적 퍼센트 10% 설정 → 게시
5. 24~48h 후 이상(크래시/ANR/리뷰) 없을 시 "릴리스 편집" → 100% 배포 확대

---
## 6. CHANGELOG & Git 태그 (선택이지만 강력 권장)
예시 CHANGELOG 항목:
```
## 1.0.0 (versionCode 2025100503)
- 첫 출시: 목표 기간 설정
- 실시간 진행 및 성공률
- 기록 상세 보기
- 상태 유지 (종료 후 재실행 복원)
```
Git 명령 (중복 태그 방지: `git tag`로 먼저 확인):
```
git add CHANGELOG.md
git commit -m "chore: release 1.0.0 (2025100503)"
git tag v1.0.0
git push
git push --tags
```

---
## 7. 릴리스 모니터링 (24~48h)
체크 포인트:
| 항목 | 위치 | 기준 |
|------|------|------|
| 크래시 | Play Console > 품질 > 크래시 & ANR | 0 또는 매우 낮음 |
| ANR | 동일 | 급증 없음 |
| 리뷰 | Play Console > 평점/리뷰 | 부정 패턴 1~2건 이상시 원인 분석 |
| 설치 증가 | 통계 | 급격한 비정상 변동 시 서버/리소스 영향 주시 |

모니터 결과 OK → 100% 확대.

---
## 8. 핫픽스 절차
문제 발견 시 (크래시/치명 UI):
1. 원인 파악 및 최소 수정
2. versionCode +1 (동일 날짜면 시퀀스 증가 / 날짜 바뀌면 새 날짜 + 00)
3. (필요 시 versionName patch 증가: 1.0.1 등)
4. AAB 재빌드 & 프로덕션(또는 내부 테스트 → 빠른 확인 → 프로덕션 100%)
5. 릴리스 노트: `Hotfix: [간단 설명]`
6. 매핑/심볼 백업 (R8 난독화 사용 시 `mapping.txt`):
```
app/build/outputs/mapping/release/mapping.txt
```
7. CHANGELOG append & git 태그 (예: v1.0.1)

---
## 9. NDK 심볼 / debugSymbolLevel 처리 (선택)
현재 설정:
```
ndk {
    debugSymbolLevel = "SYMBOL_TABLE"
}
```
- 네이티브 크래시 심층 분석이 필요 없다면 제거 가능.
- 제거 후: Play Console 심볼 경고는 무시 가능 (앱 안정성 지표 영향 거의 없음)
- 제거 타이밍: 다음 versionCode 증가 시 같이 커밋.

---
## 10. 릴리스 후 로드맵 초안
- 1.0.1: 경미한 UI/문구/성능 보정
- 1.1.0: (예) 사용자 정의 목표 다중 저장 / 알림 기능 추가
- 사전: 요구사항 → 간단 스펙 → 라벨링(Feat/Fix) → 이슈 트래킹

---
## 11. 단계별 초간단 실행 카드 (A~E)
| 코드 | 설명 | 완료 조건 | 산출 |
|------|------|-----------|------|
| A | 내부 테스트 QA 6항목 | QA PASS 메모 | 체크 기록 |
| B | (선택) CHANGELOG & 태그 | vX.Y.Z 태그 | CHANGELOG diff |
| C | 프로덕션 10% 게시 | 콘솔 상태=승인 | 릴리스 노트 |
| D | 모니터 & 100% 확장 | 안정성 OK | 확대 완료 로그 |
| E | 다음 버전 로드맵 | 초안 문서 | Backlog 정리 |

---
## 12. 릴리스 노트 템플릿
한국어 (초기):
```
1.0.0 첫 출시: 목표 기간 설정, 실시간 진행/성공률, 기록 상세, 상태 유지.
```
English:
```
1.0.0 initial release: target setup, live progress & success rate, record detail, persistence.
```
Hotfix 예시:
```
Hotfix: 앱 재시작 시 진행 상태 표시 오류 수정.
```

---
## 13. 명령 모음 (참고)
```
# AAB 빌드
gradlew :app:bundleRelease

# Lint & 테스트 (선택)
gradlew :app:lintVitalRelease
gradlew test

# CHANGELOG 커밋 & 태그
git add CHANGELOG.md
git commit -m "chore: release 1.0.0 (2025100503)"
git tag v1.0.0
git push && git push --tags
```
(Windows PowerShell에서 `./gradlew` 대신 `gradlew.bat` 사용 가능)

---
## 14. 체크 기록 예시 (내부 QA)
```
Build versionCode: 2025100503
Date: 2025-10-05
Device: Pixel 6 / Android 15
[1] 첫 실행 기본값 → OK
[2] 재실행 상태 유지 → OK
[3] 2분 진행 UI 정상 → OK
[4] 다크 모드 전환 → OK
[5] EN 로케일 → OK
[6] Logcat Error 없음 → OK
Result: QA PASS
```

---
## 15. 변경 시 유지 원칙
- release 프로세스는 문서화된 순서를 바꾸지 않는다 (A→E 흐름 유지).
- versionCode 재사용 금지 (Play 거절 원인 및 롤백 혼선 방지).
- 프로덕션 배포 전 최소 1회 내부 QA PASS 로그 필수.
- 크래시율/ANR 데이터 기준: 의미 있는 샘플(10% 롤아웃) 안정 후 확장.

---
## 16. 빠른 의사결정 가이드
| 상황 | 대응 | 비고 |
|------|------|------|
| 경미 UI 오타 | 다음 minor 릴리스에 묶음 | 핫픽스 불필요 |
| 첫날 크래시율 급증 | 즉시 핫픽스 빌드 | 단계적 5~10% 재시작 가능 |
| 단말 특이 1건 | 패턴 재현 전 관찰 | 재현률 <1% 단건이면 보류 |
| 리뷰 1성 2건 이상 동일 불만 | 원인 이슈화 & ETA 공유 | 소통(릴리스 노트/응답) |

---
## 17. 향후 개선(백로그 후보)
- CI 자동 versionCode 증가 스크립트
- QA 체크리스트 자동화 (ADB 스크립트 or Macro)
- Sentry/Crashlytics 연동으로 크래시 가시성 강화
- 릴리스 노트 다국어 자동 생성 파이프라인

---
## 18. 문서 변경 이력
| 날짜 | 변경 | 작성자 |
|------|------|--------|
| 2025-10-05 | 최초 작성 (내부 테스트→프로덕션 워크플로우) | - |
| 2025-10-05 | 섹션 19 KPI 권장 세트 추가 | - |

---
## 19. Play Console KPI 선택 (권장 세트)
초기 릴리스 단계에서 Play Console KPI 대시보드(최대 16개) 중 무엇을 선택할지에 대한 가이드. "전부 체크"는 신호 대비 잡음이 커져 실행 우선순위가 흐려지므로 아래 Core + Optional 구조를 권장.

### 19.1 Core KPI (8개) – 항상 선택
1. 활성 기기 수 (Active devices)
2. 일간 활성 사용자/기기 (DAU) *표기 형태 따라 다를 수 있음
3. 총 사용자층 규모 또는 30일 활성 사용자 (MAU)
4. 7일 유지율 (7-day retention)
5. 사용자 획득 (User acquisition / New users)
6. 사용자 손실 (Lost users / Uninstalls 사용자 기준)
7. 크래시 있는 사용자 (Users with crashes) 또는 Crash‑free %
8. ANR 비율 (ANR rate)

이 8개로 규모·참여·유지·성장·품질(안정성) 축을 모두 커버.

### 19.2 Optional (필요 시 2~3개 추가)
- 1일 유지율 (Day1 retention) – 온보딩 개선 초기 판단
- 사용자층 성장률 (28일 대비 변화율)
- 총 설치 수 (Historical 누적 참고)
- 평균 세션 수 (세션 빈도; Stickiness 보조) *세션 길이와 동시 선택 비권장
- 재설치 사용자 수 (돌아온 사용자 감지)
- 업데이트 채택률 (릴리스 사이클 가속 시)
- OS 버전 분포 (호환성/테스트 범위 판단)

### 19.3 의도적으로 제외/지연 선택하는 항목 예시
- 평균 세션 길이: 타이머 특성상 길수록 반드시 더 좋은 가치가 아님(백그라운드 방치 가능)
- 과도한 중복 지표 (총 설치 수 vs 활성 기기 수 vs 총 사용자층 규모) → 두 개 이하만 유지
- 소득/매출 관련 지표: 현재 앱 범위(MVP) 밖

### 19.4 "전부 체크" 시 단점 요약
| 문제 | 설명 | 결과 |
|------|------|------|
| 신호 희석 | 변동 큰 소수 지표가 시야 차지 | 잘못된 우선순위
| 분석 피로 | 매일 살펴볼 그래프 과잉 | 핵심 이상 징후 감지 지연
| 거짓 경보 증가 | 표본 작은 지표 급등락 | 불필요한 조사/핫픽스 충동
| 중복 | 의미 겹침 (설치/활성/총 규모) | 해석 혼선
| 목표 문화 약화 | KPI=모두 → 책임 모호 | 실행 속도 저하

### 19.5 주간 리뷰 Quick Table 템플릿
```
Week (ISO): 2025-W41
DAU: ___   MAU: ___   DAU/MAU: ___%
7d Retention: ___%  D1 Retention(옵션): ___%
User Acquisition: ___   User Loss: ___   Net(+/-): ___
Crash-free Users: ___%   ANR rate: ___%
주요 메모: (이상 징후 / 가설 / 다음 액션)
```

### 19.6 선택 결과 기록 템플릿
```
선택 날짜: 2025-10-05
Core: 활성 기기 수, DAU, 총 사용자층 규모(MAU), 7일 유지율, 사용자 획득, 사용자 손실, 크래시 있는 사용자, ANR 비율
Optional: 1일 유지율, 사용자층 성장률, 총 설치 수
비고: 초기 2주 후 Optional 재평가 예정
```

### 19.7 운영 원칙
- Core 8개는 분기 변경 최소화 (지속성 유지)
- Optional 재평가 주기: 월 1회 (삭제/교체 허용)
- 신규 기능이 North Star 후보 지표에 영향 줄 가설 생기면 Optional 슬롯으로 시험 후 Core 편입 검토
- 품질 지표(Crash/ANR)는 99.5% Crash-free, ANR <0.5% 달성 못 하면 다른 실험 보류

---
본 문서는 실제 실행 중 식별된 개선점을 소규모 PR로 지속 반영하는 Living Document 입니다.
